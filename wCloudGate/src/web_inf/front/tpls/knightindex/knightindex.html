<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>外麦王云平台</title>
	<link rel="stylesheet" type="text/css" href="/css/common.css"/>
	<link rel="stylesheet" type="text/css" href="/css/commonsector.css"/>
	<link rel="stylesheet" type="text/css" href="/css/index/index.css"/>
</head>
<body>

	<?php include("header.html"); ?>

	<section>
		<div class="content">
			<div class="contentleft">
				<div class="searchbox">
                    <div class="search">
						 <input type="text" name="laborname"  placeholder="搜索劳务方" />
                         <button class="searchbtn">搜索</button>
					</div>					
				</div>
				<div class="sortmain">
                    <?php if(empty($get)){echo "<p class='allsort sortactivec'>总览</p>";}else{echo "<p class='allsort'>总览</p>";} ?>
                    <div class="sortbox">
                        <?php
                            for($i=0;$i<count($labor);$i++)
                            {
                            if($get == $labor[$i]['id']){
                                $class = "sortactivec";
                            }else{
                                $class = "";    
                            }                                
                                echo "<p class='sortp ".$class."' laborid='{$labor[$i]['id']}' userid='{$userid}'>".$labor[$i]['name']."</p>";
                            }
                        ?>
                        <!-- <p class="sortp sortactivec">锋速外卖配送有限公司锋速外卖配送有限公司</p>-->			
					</div>
				</div>
			</div>

			<div class="contentright">
				<div class="crtop">															今日通知：近期连续强降雨，部分路段湿滑，各位骑士请注意交通安全！
				</div>
				<div class="cartitle">
					<svg class="nc-icon outline" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24">
						<g transform="translate(0, 0)">
						<path fill="none" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M3,17V7c0-1.1,0.9-2,2-2h14
							c1.1,0,2,0.9,2,2v10" stroke-linejoin="round"></path>
						<path fill="none" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M23,17L23,17
							c0,1.1-0.9,2-2,2H3c-1.1,0-2-0.9-2-2v0H23z" stroke-linejoin="round"></path>
						<line data-color="color-2" fill="none" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" x1="12" y1="14" x2="12" y2="8" stroke-linejoin="round"></line>
						<line data-color="color-2" fill="none" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" x1="16" y1="14" x2="16" y2="10" stroke-linejoin="round"></line>
						<line data-color="color-2" fill="none" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" x1="8" y1="14" x2="8" y2="12" stroke-linejoin="round"></line>
						</g>
					</svg>
					<p>车辆统计</p>
				</div>
				<ul class="vehicle">
					<li>
						<div class="num num1">
							<?=$ebikesum?>
						</div>
						<p class="carp">所有车辆</p>
						<div class="progressbar">
							<div class="pbar1"></div>
						</div>
						<div class="carbtn">
							<div class="carinf">
                                <a href="<?php if(empty($get)){echo "/platform/carmanagement.php";}else{echo "/platform/carmanagement.php?labour=".$get;}?>">车辆信息</a>
							</div>
							<div class="checkpos">
								<a href="javascript:void(0)">查看定位</a>
							</div>
						</div>
					</li>
					<li>
					 	<div class="num num2">
							<?=$runnum?>
						</div>
						<p class="carp">正在运行</p>
						<div class="progressbar">
							<div class="pbar2"></div>
						</div>
						<div class="carbtn">
							<div class="carinf">
                                <a href="<?php if(empty($get)){echo "/platform/carmanagement.php";}else{echo "/platform/carmanagement.php?labour=".$get;}?>">车辆信息</a>
							</div>
							<div class="checkpos">
								<a href="javascript:void(0)">查看定位</a>
							</div>
						</div>
					</li>
					<li>
						<div class="num num3">
							<?=$batalarm?>
						</div>
						<p class="carp">电量告警</p>
						<div class="progressbar">
							<div class="pbar3"></div>
						</div>
						<div class="carbtn">
							<div class="carinf">
                                <a href="<?php if(empty($get)){echo "/platform/carmanagement.php?abnormal=2";}else{echo "/platform/carmanagement.php?abnormal=2&labour=".$get;}?>">车辆信息</a>
							</div>
							<div class="checkpos">
								<a href="javascript:void(0)">查看定位</a>
							</div>
						</div>
					</li>
					<li>
						<div class="num num4">
							<?=$restnum?>
						</div>
						<p class="carp">正在休息</p>
						<div class="progressbar">
							<div class="pbar4"></div>
						</div>
						<div class="carbtn">
							<div class="carinf">
                                <a href="<?php if(empty($get)){echo "/platform/carmanagement.php";}else{echo "/platform/carmanagement.php?labour=".$get;}?>">车辆信息</a>
							</div>
							<div class="checkpos">
								<a href="javascript:void(0)">查看定位</a>
							</div>
						</div>
					</li>
				</ul>
				
				<div class="cartitle">
					<svg class="nc-icon outline" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24">
						<g transform="translate(0, 0)">
						<path fill="none" stroke="#666666" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M3,17V7c0-1.1,0.9-2,2-2h14
							c1.1,0,2,0.9,2,2v10" stroke-linejoin="round"></path>
						<path fill="none" stroke="#666666" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M23,17L23,17
							c0,1.1-0.9,2-2,2H3c-1.1,0-2-0.9-2-2v0H23z" stroke-linejoin="round"></path>
						<polyline data-cap="butt" data-color="color-2" fill="none" stroke="#666666" stroke-width="2" stroke-miterlimit="10" points="17,9 12,14 9,11 7,13 
							" stroke-linejoin="round" stroke-linecap="round"></polyline>
						<polyline data-color="color-2" fill="none" stroke="#666666" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" points="
							14,9 17,9 17,12 " stroke-linejoin="round"></polyline>
						</g>
					</svg>
					<p>车辆数据统计</p>
				</div>
				<div class="datanews">
					<div class="datacontent">
						<div id="carvalarm" style="width: 780px;height:266px;padding-bottom:0;margin-left:10px;"></div>
						<div id="carpalarm" style="width: 780px;height:266px;padding-bottom:0;margin-left:10px;"></div>
						<div id="carlostcon" style="width: 780px;height:266px;padding-bottom:0;margin-left:10px;"></div>
					</div>

				</div>
				
			</div>
		</div>
	</section>
	<div class="push"></div>
	<div>
		<?php include("footer.html"); ?>		
	</div>
	<script src="/js/jquery-1.8.2.min.js"></script>
	<script src="/js/main/echarts.common.min.js"></script>
	<script src="/js/common.js"></script>
	<script src="/js/statistics.js"></script>
    <script src="/js/navigation/bars.js"></script>
    <script src="/js/util.js"></script>
	<script type="text/javascript">
        $(function(){
            var num1 = $(".num1").html();
            var num2 = $(".num2").html();
            var num3 = $(".num3").html();
            var num4 = $(".num4").html();
            if(num1 ==0 ){var allebike=0; }else{var allebike=100;}
            var runnum = (num2/num1)*100;
            var warmnum = (num3/num1)*100;
            var restnum = (num4/num1)*100;
			$(".pbar1").animate({width: allebike}, 1000);
			$(".pbar2").animate({width: runnum}, 1000);
			$(".pbar3").animate({width: warmnum}, 1000);
			$(".pbar4").animate({width: restnum}, 1000);
            $(document).on("click",".sortp",function(){
				$(".sortp").each(function(){
					$(this).removeClass("sortactivec");
                })
                 $(".allsort").removeClass("sortactivec");    
                 var laborid = $(this).attr("laborid");
                 var userid = $(this).attr("userid");
                 window.location = "main.php?laborid="+laborid;
               $(this).addClass("sortactivec");
            })
            $(".allsort").click(function(){
                window.location = "main.php";
            })
            
            $(".searchbtn").click(function(){
                var laborname = $("input[name=laborname]").val(); 
                var data = {name:laborname}
                util.ajax_post("searchlabor.php" , data , labSuccess, labFail);                            
             })
             $(document).ready(function(e) {
                 $("input[name=laborname]").keydown(function (e){
                     if(e.which == "13"){
                         var laborname = $("input[name=laborname]").val(); 
                         var data = {name:laborname}
                         util.ajax_post("searchlabor.php" , data , labSuccess, labFail);
                     }
                })
             });
             function labSuccess(data)
             {
                 if(data == null){
                    $(".sortbox").empty();
                 }else{
                     var str = "";
                     for(var i=0;i<data.length;i++){
                         str += "<p class='sortp' laborid='"+data[i]['id']+"'>"+data[i]['name']+"</p>";
                     }
                     $(".sortbox").empty().append(str);
                 } 
             }
            function labFail(data){}
		})
        // 基于准备好的dom，初始化echarts实例
        /*var myChart1 = echarts.init(document.getElementById('maindrivekm'));
        var myChart2 = echarts.init(document.getElementById('mainpower'));
        var myChart3 = echarts.init(document.getElementById('mainspeed'));
        var option1 = {
		    title : {
		        text: '行驶公里数',
		        subtext: '单位:公里(km)'
		    },
		    tooltip : {
		        trigger: 'axis'
		    },
		    legend: {
		        data:['行驶公里数']
		    },
		    toolbox: {
		        show : true,
		        feature : {
		            mark : {show: true},
		            dataView : {show: true, readOnly: false},
		            magicType : {show: true, type: ['line', 'bar']},
		            restore : {show: true},
		            saveAsImage : {show: true}
		        }
		    },
		    calculable : true,
		    xAxis : [
		        {
		            type : 'category',
		            boundaryGap : false,
		            data : ['周一','周二','周三','周四','周五','周六','周日']
		        }
		    ],
		    yAxis : [
		        {
		            type : 'value'
		        }
		    ],
		    series : [
		        {
		            name:'行驶公里数',
		            type:'line',
		            smooth:true,
		            itemStyle: {normal: {areaStyle: {type: 'macarons'}}},
		            data:[10, 29, 21, 54, 36, 19,10]
		        }
		    ],
		    color: ['#62d7c8']
		};
		var option2 = {
		    title : {
		        text: '耗电量',
		        subtext: '单位:千瓦(kw)'
		    },
		    tooltip : {
		        trigger: 'axis'
		    },
		    legend: {
		        data:['耗电量']
		    },
		    toolbox: {
		        show : true,
		        feature : {
		            mark : {show: true},
		            dataView : {show: true, readOnly: false},
		            magicType : {show: true, type: ['line', 'bar']},
		            restore : {show: true},
		            saveAsImage : {show: true}
		        }
		    },
		    calculable : true,
		    xAxis : [
		        {
		            type : 'category',
		            boundaryGap : false,
		            data : ['周一','周二','周三','周四','周五','周六','周日']
		        }
		    ],
		    yAxis : [
		        {
		            type : 'value'
		        }
		    ],
		    series : [
		        {
		            name:'耗电量',
		            type:'line',
		            smooth:true,
		            itemStyle: {normal: {areaStyle: {type: 'macarons'}}},
		            data:[30, 24, 38, 62, 45, 30,10]
		        }
		    ],
		    color: ['#f2e8ee']
		};
		var option3 = {
		    title : {
		        text: '车速',
		        subtext: '单位:公里(km)/小时(h)'
		    },
		    tooltip : {
		        trigger: 'axis'
		    },
		    legend: {
		        data:['车速']
		    },
		    toolbox: {
		        show : true,
		        feature : {
		            mark : {show: true},
		            dataView : {show: true, readOnly: false},
		            magicType : {show: true, type: ['line', 'bar']},
		            restore : {show: true},
		            saveAsImage : {show: true}
		        }
		    },
		    calculable : true,
		    xAxis : [
		        {
		            type : 'category',
		            boundaryGap : false,
		            data : ['周一','周二','周三','周四','周五','周六','周日']
		        }
		    ],
		    yAxis : [
		        {
		            type : 'value'
		        }
		    ],
		    series : [
		        {
		            name:'车速',
		            type:'line',
		            smooth:true,
		            itemStyle: {normal: {areaStyle: {type: 'macarons'}}},
		            data:[52, 40, 21, 35, 49, 63,34]
		        }
		    ],
		    color: ['#c185ff']
		};
        // 使用刚指定的配置项和数据显示图表。
        myChart1.setOption(option1);
        myChart2.setOption(option2);
        myChart3.setOption(option3);*/
    </script>

    
</body>
</html>
